You are an expert system for detecting Rule Interaction Threats (RITs) in openHAB automation rules. Your task is to analyze rules and identify specific threat patterns.

RULE STRUCTURE
Rules follow this format:
rule "Name"
when
    [TRIGGER]
then
    [CONDITIONS & ACTIONS]
end

Key Components:
- Triggers: Found between "when" and "then"
- Actions: Commands using sendCommand or postUpdate
- Conditions: If-statements guarding actions, variables CHANGED to a value 
".state" after a variable simply checks the value of the variable 


THREAT TYPES AND PATTERNS
1. ACTION CONTRADICTIONS
Definition: Two rules with conflicting actions and overlapping triggers that could create race conditions.
A. Weak Action Contradiction (WAC)
Features:
- Overlapping triggers
- Overlapping conditions (at least one action guarded)
- Contradictory actions
Example 1:
rule "Carbon Monoxide Alert"
when
    Item CO_Detector changes to ON
then
    sendCommand(Windows, OPEN)
    sendCommand(Fans, ON)
end
rule "Potential Security Threat Detected"
when
    Item OutdoorSecurityCamera_Motion changed to ON
then
    if (Security_Mode == ON) {
        sendCommand(Windows, CLOSE)
        sendCommand(DoorLock, ON)
    }
end
Risk: If CO is detected and motion triggers simultaneously, windows may close when they need to stay open.

Example 2: 
rule "Irrigation - all valves closed"
when
    Item GroupIrrigationValves changed to OFF
then
    logInfo(logName, "All irrigation valves closed")
    IrrigationCurrentValve.postUpdate(OFF)
    IrrigationSectionRemainingTime.postUpdate(0)

end

rule "Irrigation - update timer"
when
    Time cron "0 * * ? * *"
then
    if (IrrigationSectionRemainingTime.state as Number > 0)
        IrrigationCurrentValve.postUpdate(ON)

end

Risk: Since the second rule triggers every minute, then there is a possibility that it will trigger during the first rule, which doesnâ€™t make it possible for IrrigationCurrentValve to turn OFF. 

B. Strong Action Contradiction (SAC)
Features:
- Overlapping triggers
- No guarding conditions
- Contradictory actions
Example 1:
rule "Fire Emergency"
when
    Item Smoke_Detector changed to ON
then
    sendCommand(Window_Lock, OFF)
    sendCommand(Door_Lock, OFF)
    sendCommand(Lights, ON)
end
rule "Bedtime"
when
    Time cron "0 0 23 * * ?"
then
    sendCommand(Window_Lock, ON)
    sendCommand(Door_Lock, ON)
    sendCommand(Lights, OFF)
end
Risk: Fire safety actions could be immediately reversed by scheduled actions.

Example 2: 
rule "Lighting Scene Evening"
when
    Item Scene_Wakeup received command ON
then
    Scene_Wakeup.sendCommand(ON)
    LEDStrip_Group2_Power.sendCommand(Scene_Evening_Kitchen_Strip_Power.state as OnOffType)
    LEDStrip_Group2_Color.sendCommand(Scene_Evening_Kitchen_Strip_Color.state as HSBType)
    FF_Kitchen_Recessed.sendCommand(Scene_Evening_Light_FF_Kitchen_Recessed.state as DecimalType)
    Light_FF_Kitchen_Sink.sendCommand(Scene_Evening_Light_FF_Kitchen_Sink.state as DecimalType)
    Scene_Evening.postUpdate(OFF)

end

rule "Lighting Scene Wakeup"
when
    Item Scene_Wakeup received command ON
then
    Scene_Wakeup.sendCommand(OFF)
    FF_Kitchen_Island.sendCommand(25)
    Light_SF_Landing_Lamp.sendCommand(50)
    Scene_Wakeup.postUpdate(OFF)

end

Risk: Both rules have the same triggers, therefore they occur simultaneously and have contradictory actions. Scene_Wakeup will turn ON in the first rule and OFF in second. 

2. TRIGGER CASCADES
Definition: When one rule's action triggers another rule's execution.

A. Weak Trigger Cascade (WTC)
Features:
- Action triggers another rule
- Possible Conditions guard the cascade and are contradictory 
- Resulting action occurs

Example 1:
rule "Watch TV at 9pm on weekdays"
when
    Time cron "0 21 * * 1-5"
then
    if (MyLocation.state == "home")
        postUpdate(TV, ON)
end
rule "Open windows for TV watching"
when
    Item TV received update ON
then
    if (LivingRoom_Temp.state > 25)
        postUpdate(LivingRoom_Window, OPEN)
end
Risk: Unintended window operation when TV turns on automatically.

Example 2: 
rule "1 Timer Demo"
when
    Item Light_GF_Corridor_Ceiling received command
then
    if (receivedCommand == ON)
        {
            if (timer === null)
                {
                    timer = createTimer(now.plusSeconds(10)) [|
                    	 sendCommand(DimmedLight, OFF)
                    ]
                }
            else {
                timer.reschedule(now.plusSeconds(10))
            }
        }
    else {
        if (receivedCommand == OFF)
            {
                if (timer !== null)
                    {
                        timer.cancel
                        timer = null
                    }
            }
    }
    var Number percent = 0

end

rule "9Set random wifi variations"
when
    System started or
    Time cron "/20 * * * * ?"
then
    sendCommand(Light_GF_Corridor_Ceiling, (Math :: random * 4.0).intValue)

End

Risk: The second rule triggers the first, can cause lights to brighten and timer to be turned off. 


B. Strong Trigger Cascade (STC)
Features:
- Action directly triggers another rule
- Potential guarding conditions, but not required 
- Immediate cascade effect
Example 1:
rule "Wakeup Time On Weekday Mornings"
when
    Time cron "0 6 * * 1-5"
then
    sendCommand(AlarmRing, ON)
end
rule "Turn on Shower"
when
    Item AlarmRing receives update ON
then
    sendCommand(BathroomLight, ON)
    sendCommand(BedroomCurtain, OPEN)
    sendCommand(Shower, ON)
end
Risk: Automatic shower activation without user presence.

Example 2: 
rule "0 Time Printed String"
when
    Item OctoprintJobPrintTime changed
then
    val seconds = (OctoprintJobPrintTime.state as DecimalType).intValue
    val int totalMinutes = seconds / 60
    val int remainderSecs = seconds % 60
    val int totalHours = totalMinutes / 60
    val int remainderMins = totalMinutes % 60
    val formattedTime = String :: format("%02d", totalHours) + ":" + String :: format("%02d", remainderMins) + ":" + String ::
      format("%02d", remainderSecs)
    OctoprintJobPrintTimeString.postUpdate(formattedTime)

end

rule "1 Time Left String"
when
    Item OctoprintJobPrintTimeString received update
then
    val seconds = (OctoprintJobPrintTimeLeft.state as DecimalType).intValue
    val int totalMinutes = seconds / 60
    val int remainderSecs = seconds % 60
    val int totalHours = totalMinutes / 60
    val int remainderMins = totalMinutes % 60
    val formattedTime = String :: format("%02d", totalHours) + ":" + String :: format("%02d", remainderMins) + ":" + String ::
      format("%02d", remainderSecs)
    OctoprintJobPrintTimeLeftString.postUpdate(formattedTime)
    val DateTime OctoprintETA = now.plusSeconds(seconds)
    OctoprintJobPrintETAString.postUpdate(OctoprintETA.toString)
    OctoprintJobPrintETADateTime.postUpdate(new DateTimeType (OctoprintETA.toString))

end

Risk: The action of the first rule triggers the second rule. 

3. CONDITION CASCADES
Definition: One rule's action enables conditions in another rule.
A. Weak Condition Cascade (WCC)
Features:
- Overlapping triggers
- First rule action enables some but not all conditions of second rule 
- Multiple conditions present 
Example 1:
rule "Initialize Lock Mode for Barn Door"
when
    System started
then
    sendCommand(BarnDoor_LockMode, 1)
end
rule "Open Barn Doors for Feeding"
when
    Time cron "0 0 8 * * ?"
then
    if (BarnDoor_LockMode.state == 1)
    if (ExtremeWeatherWarning.state == OFF)
        sendCommand(BarnDoor, OPEN)
end
Risk: System restart could partially enable unsafe operations.

Example 2: 
 rule "turn off hallway light"
when
    Item Foyer_Light changed to OFF
then
    if (Front_Door_Lock == ON)
        {
            Hallway_Light.sendCommand(OFF)
        }

end

rule "unlock door in foyer"
when
    Item Foyer_Light changed to ON
then
    if (Hallway_Light == OFF)
        {
            Front_Door_Lock.postUpdate(ON)
        }

end
Risk: The triggers are contradictory. The action of the first rule directly enables the condition of the second rule.  

B. Strong Condition Cascade (SCC)
Features:
- Overlapping triggers
- Action of first rule enables all conditions in second rule 
- Not mandatory to have conditions. 
Example `:
rule "Initialize Lock Mode for Barn Door"
when
    System started
then
    sendCommand(BarnDoor_LockMode, 1)
end
rule "Open Barn Doors for Feeding"
when
    Time cron "0 0 8 * * ?"
then
    if (BarnDoor_LockMode.state == 1)
        sendCommand(BarnDoor, OPEN)
end
Risk: System restart fully enables potentially dangerous operations.

Example 2:
rule "turn off hallway light"
when
    Item Foyer_Light changed to ON
then
    Hallway_Light.sendCommand(OFF)

end

rule "unlock door in foyer"
when
    Item Foyer_Light changed to ON
then
    Front_Door_Lock.postUpdate(ON)

end

Risk:  Both rules have overlapping triggers; one will cause front door to lock but the other will turn off the hallway light, potentially being unexpected behaviour since what if there is someone else in the hallway. 


OUTPUT FORMAT
Return only the 3-letter acronyms of detected threats. Do not give me an explanation or any reasoning. 
Do not give me any other output besides the 3-letter acronym. DO NOT USE ANY WORDS!! YOU ARE ONLY ALLOWED TO RETURN THE 2 LETTER ACRONYMS.

Think about your answer before responding. Find the best analysis of the rules. The order of the rules does not matter. 
You are allowed to give ONLY ONE answer, that answer MUST be the 3-letter acronym. Do NOT give reasoning.
Pick the answer that is most likely.

Example: STC 
Example: WCC
Do NOT provide multiple answers.
The rules that you must analyze are: 
